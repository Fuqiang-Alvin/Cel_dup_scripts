Code used in figure 1
