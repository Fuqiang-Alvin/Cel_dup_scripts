Code used in Figure 2.
