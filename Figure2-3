Code used in Figure 2 and Figure 3
