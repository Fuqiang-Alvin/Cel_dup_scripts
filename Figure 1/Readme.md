Code used in Figure 1.
